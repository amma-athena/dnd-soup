<!doctype html>

<html class="no-js" lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- Page Info -->
	<link rel="shortcut icon" href="/imgs/favicon.png">
	<title>Ill Tills â Darknet Diaries</title>
	<meta name="description" content="A major retailer was hacked. Their point of sales machines were riddled with malware. Listen to hear how digital forensics and incident responders handled the situation. What malware was found? Whe...">
	<meta name="keywords" content="darknet, diaries, podcast, darkweb, dark, web, stories, crypto, hacking, hackers, hackable, breach, virus, malware, botnet, intrusion, sysadmin, privacy, Internet, infosec, security, information security, secops" />



	<!-- Twitter Card -->
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:title" content="Ill Tills â Darknet Diaries">  
	<meta name="twitter:description" content="A major retailer was hacked. Their point of sales machines were riddled with malware. Listen to hear how digital forensics and incident responders handled the situation. What malware was found? Whe...">
	<meta name="twitter:image" content="https://darknetdiaries.com/imgs/illtill.jpg" />

	<!-- Facebook OpenGraph -->
	<meta property="og:url"                content="https://darknetdiaries.com/transcript/15/" />
	<meta property="og:type"               content="article" />
	<meta property="og:title"              content="Ill Tills â Darknet Diaries" />
	<meta property="og:description"        content="A major retailer was hacked. Their point of sales machines were riddled with malware. Listen to hear how digital forensics and incident responders handled the situation. What malware was found? Where was it found? How was it stopped? And most importantly, how much data was leaked?" />
	<meta property="og:image"              content="https://darknetdiaries.com/imgs/illtill.jpg" />



	<!-- Podcasts -->
	<meta name="apple-itunes-app" content="app-id=1296350485">
	<link rel="canonical" href="https://darknetdiaries.com/transcript/15/">
	<link type="application/rss+xml" rel="alternate" title="Darknet Diaries" href="https://feeds.megaphone.fm/darknetdiaries">


	<link rel="image_src" href="https://darknetdiaries.com/imgs/illtill.jpg">

	
	<!-- Font Embed Code -->
	<link href="https://fonts.googleapis.com/css?family=Anton" rel="stylesheet">
	

	<!-- Styles -->
	<link rel="stylesheet" href="/css/style.css">
	
	<!-- Icons -->
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/solid.js" integrity="sha384-GXi56ipjsBwAe6v5X4xSrVNXGOmpdJYZEEh/0/GqJ3JTHsfDsF8v0YQvZCJYAiGu" crossorigin="anonymous"></script>
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/brands.js" integrity="sha384-0inRy4HkP0hJ038ZyfQ4vLl+F4POKbqnaUB6ewmU4dWP0ki8Q27A0VFiVRIpscvL" crossorigin="anonymous"></script>
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/fontawesome.js" integrity="sha384-NY6PHjYLP2f+gL3uaVfqUZImmw71ArL9+Roi9o+I4+RBqArA2CfW1sJ1wkABFfPe" crossorigin="anonymous"></script>

	
	<!-- Custom Styles -->
	<link rel="stylesheet" href="/css/custom.css">
	

	
	<!-- Extra Header JS Code -->
	
	
	
</head>


<body class="loading" data-site-url="https://darknetdiaries.com" data-page-url="/transcript/15/">


	

<header class="header">

	<div class="wrap">
		
		<a href="/" class="header__title">
			Darknet Diaries
		</a>
		

		<div class="menu">
			<div class="menu__toggle js-menu-toggle">
				<div class="menu__toggle__icon"><span></span></div>
			</div>
			<div class="menu__wrap">
				<ul class="menu__list">
					
					<li class="menu__list__item">
						<a href="/episode/" class="menu__list__item__link"><h5>Episodes</h5></a>
					</li>
					
					<li class="menu__list__item">
						<a href="/bonus/" class="menu__list__item__link"><h5>Bonus Episodes</h5></a>
					</li>
					
					<li class="menu__list__item">
						<a href="/es/" class="menu__list__item__link"><h5>EspaÃ±ol</h5></a>
					</li>
					
					<li class="menu__list__item">
						<a href="https://shop.darknetdiaries.com" class="menu__list__item__link"><h5>Shop</h5></a>
					</li>
					
					<li class="menu__list__item">
						<a href="/search/" class="menu__list__item__link"><h5>Search</h5></a>
					</li>
					
				</ul>
			</div>
		</div>

	</div>

</header>


	<div class="loader"><svg width="120" height="30" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg"><circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="60" cy="15" r="9" fill-opacity="0.3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="0.5" to="0.5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle></svg></div>

	<div class="page-loader"></div>

	
	<div class="page">

		<div class="page__content" data-page-title="Ill Tills â Darknet Diaries">

			<section class="hero hero--single">

	<div class="hero__image" style="background-image: url(/imgs/illtill.jpg)">
		<div class="hero__overlay"></div>
	</div>

	<div class="wrap">

		<h1>EP 15: Ill Tills</h1>
	</div>

</section>

<section class="single">

	<div class="wrap">

		<article class="single-post">
	
			<script>
			window.playerConfiguration = {
			"options": {
	            "themeHtml": "https://darknetdiaries.com/css/player-theme.html",
	            "themeCss" : "https://darknetdiaries.com/css/player-theme.css"
	         },
			 "extensions": {
			   "EpisodeInfo": {},
			   "Share": {}
			 },
			 "podcast": {
			   "feed": "https://feeds.megaphone.fm/darknetdiaries"
			 },
			 "episode": {
			   "media": {
			     "mp3": "https://traffic.megaphone.fm/ADV2718856516.mp3"
			   },
			   "coverUrl": "https://darknetdiaries.com/imgs/darknet-diaries-sm.jpg",
			   "url": "https://darknetdiaries.com/episode/15/",
			   "title": "Ep 15: Ill Tills"
			 }
			}
			</script>
			<script class="podigee-podcast-player" src="https://cdn.podigee.com/podcast-player/javascripts/podigee-podcast-player.js" data-configuration="playerConfiguration"></script>

			
			<p><a href="/episode/15">Episode Show Notes</a></p>
			

			<pre>
							
			<p>[FULL TRANSCRIPT]</p>

<p>TOM:	I was having trouble sleeping one evening.  I had gone to bed and then I woke up, so I went downstairs to just futz around for a little bit.  I turned on my computer and I was looking at my e-mail and here was a message from my bank, B of A, saying that my account had dropped below $25.  [MUSIC]  At the time, it didnât trigger anything in me because I only â I knew I had about thirty-something dollars in it and it was a account that I used to keep money for equipment materials, that type of thing, for my business.  But anyway, so I thought of that and just eh, okay, fine.  Then I went back to sleep and when I finally got up in the morning, all of a sudden Iâm sitting there making my coffee and Iâm going well, why did my account go down below $25?  I havenât used that account in a couple of weeks.
<!--more--></p>

<p>JACK:	This is Tom.  Heâs just found out that somebodyâs used his credit card without his approval.</p>

<p>TOM:	Obviously things are shot so I immediately called the bank and I said I donât know whatâs going on but I got a notice from B of A that I was overdrawn.  Their fraud department said okay, fine, and they started a deal and immediately notified me that my accounts were frozen and that I couldnât do anything.  This was kind of a frustrating thing.  Iâm sitting there saying to myself now, now how in the hell could that happen?</p>

<p>JACK (INTRO):	[INTRO MUSIC] These are true stories from the dark side of the internet.  Iâm Jack Rhysider.  This is Darknet Diaries.  [INTRO MUSIC ENDS]</p>

<p>JACK:	This is the story about a time when a major retail outlet got hacked.  Iâm not going to give the name of the store or even when this occurred because those details arenât important.  This story is fascinating enough without it.  This company is huge so they have thousands of stores in the US and many more all across Europe and Asia.  They do business both online and with physical stores all over the world.  Of course, each of their physical stores have computers that are connected to the network.  This story starts out with an e-mail.</p>

<p>One of their credit card brands had found some cards on the black market being sold and they were linked to this store.  The card brand e-mailed the store, letting them know some cards that are on the black market have a common purchase point of these retail stores.  Specifically they found ten credit cards on the black market whose last purchase was this store.  Now, ten credit cards found on the black market is not really that big of a deal, especially when credit card dumps have tens of thousands of cards in them.  But this store wanted to investigate anyways so they called a consulting firm called Kroll.</p>

<p>KROLL:	Hello?</p>

<p>COMPANY:	Hey.</p>

<p>JACK:	And they asked Kroll to investigate their network and try to find if there was any traces of malware on it.  They got a team to help them out.  Letâs meet two of the members of that team.</p>

<p>COURTNEY:	My nameâs Courtney Dayter.  Iâm a Senior Managing Consultant.</p>

<p>MATT:	My name is Matt Bromiley.</p>

<p>JACK:	Both Courtney and Matt are incident responders.  Their job is to go into a network that is breached or may have been breached and find, isolate, and fix the problems.  Both of them are used to working on larger cases and specifically cases involving finance and retail.  Doing an incident response for a global retail company is what theyâre good at.  These two got right to work looking for any signs of hackers in the network.</p>

<p>MATT:	We usually start with [00:05:00] two different approaches.  Number one, weâll start to understand whatâs already been out there.  What type of data has been leaked and is it something that could actually be resulting from a breach?  Thatâs kind of number one.  Number two is weâll also come in and drop in whatever tech we use.  The tool that we use primarily is Carbon Black which is an end-point monitoring tool, end-point monitoring and analysis tool.</p>

<p>We use Carbon Black when we deployed that throughout the environment.  Itâs usually that two-step approach; is to quantify the data thatâs been exposed, drop in our tech and we start to get deployment throughout the entire environment.  This particular customer has over ten thousand systems globally.  Theyâre acting in every major country thatâs out there.  Theyâve got outlets in every single one, if you will.  We were deployed on a global scale to almost every system that they owned that was running Windows and that could handle the agentâs software.  Basically everything Windows XP and above.</p>

<p>JACK:	The computers at each of these stores had antivirus running but it wasnât picking anything up.  The end-point monitoring software wasnât finding a lot, either.  But the storeâs IT team had noticed one system was acting funny.  So they took it offline and asked Matt and Courtney to look into it.</p>

<p>COURTNEY:	Originally the company had identified that first system for us.  It was actually already identified; they had pulled it offline so that was somewhere where we were able to look.</p>

<p>MATT:	This particular system, it looked like a bloody murder scene.  When you just take a look at this system, itâs just stuff everywhere.  Thereâs malware all over the place.  We also found several directories full of nonsensical binary data files that just didnât have much of anything inside of them but there was size to them.  On Windows environments, very rarely do you come across just blobs of data that donât have any structure or purpose or are in the wrong place like these files were.  We came across thousands of them.  Every single file, believe it or not, also had the same naming convention.  It was a six-digit date, so month, day, year, followed by a host name, followed by a seemingly random string of digits.</p>

<p>JACK:	These weird and unusual files were encrypted so neither the company or the team could see what was in them.</p>

<p>COURTNEY:	Based off of some of the information that we found in different logs, we were able to basically track the different IP addresses where that account that was owned was also reaching out to.  From doing that we were able to see where it was reaching out and where they were pushing malware to from that machine, as well.  Then in doing so, we also found additional malware as we kept going out.  It was just more and more specific variations of the same malware.  From there, we were able to get most of it and then we got to a second major host machine and we were able to then spawn out from that one as well.  Then weâre back to the third one.</p>

<p>MATT:	We identified upwards of about twelve hundred compromised systems.  [MUSIC]  The malware sits on these systems, scrapes all this data out of memory, and then it pushes that data over the wire to the central repository system.</p>

<p>COURTNEY:	This particular malware was writing to an output file so we knew that this malware was writing to a particular output file with a particular file extension.  We were going, looking across the network for all of the files with the same similar naming patterns and similar file extensions.  We also looked at the different malwares âcause some of them have a different naming convention in each of the different output files.  We made sure we were able to determine all the output files.  We pulled them all together.</p>

<p>JACK:	At this point the team had found over one thousand computers all in the network with the same malware.  But hereâs the worst part; want to guess what these computers were used for?</p>

<p>MATT:	Theyâre the cash registers where you go buy something and you swipe your card, or you insert your card.  These days you insert pin and chip, sometimes you still swipe depending, but the systems that are compromised are those particular systems.</p>

<p>JACK:	Malware that exists on twelve hundred computers that are cash registers is terrifying.  The team began studying this malware to try to understand what itâs doing.  The output files were encrypted using XOR and the company couldnât decipher it.  But Matt and Courtney spent some time and eventually cracked the encryption.  They were able to see what was in those files.  What they saw confirmed their fears; the malware was grabbing every credit card that was swiped on that register and putting it in this file.</p>

<p>COURTNEY:	[00:10:00] The way that they were scraping cards were â they were scraping from memory.  But they did it using fifteen and sixteen-digit characters, so they were pulling anything that was fifteen to sixteen digits and usually itâs followed by something along the lines of an equal sign or some sort of delimiter and then it gives you the four digit expiration number.  Based off of that, thatâs where they were able to pull card data down from memory, and using that basic algorithm they were able to get mostly positives but occasionally you do get a few false positives and some of the things that are scraped.</p>

<p>JACK:	This company is now in a nightmare scenario.  So many of their cash registers have malware on it thatâs scraping every credit card thatâs being processed and then sending that data out of the network.  As the credit card data leaks out of the company and into the wrong hands, the criminals who get these cards can use them for themselves.  They do things like write the card data to a blank credit card and then withdraw cash from ATMs or use these cards to buy gift cards and sort of launder the money.  The thieves found a spring of seemingly endless money and they were making some serious cash off this retail company.</p>

<p>MATT:	Our mutual feeling was thereâs gonna be a lot of data here.  I donât know, the initial thing that you think about â and itâs like an investigatorâs curse.  You never want this number to be high but one of the first things you think about his how much data has been stolen?  How much data has actually been accessed?  âCause when youâve got that much malware in an environment that big, the first thing you have to think is Iâve just found thousands of output files; what are the chances that Iâm also looking at millions of credit card numbers?  You never want to be in that target world.  Right, those tens of millions of numbers and that kind of stuff.</p>

<p>You never want to be there but unfortunately when you uncover a breach this big, one of the things that creeps into your mind is please, please, please, donât be that large.  But wait, that was North America.  We found the exact same type of infrastructure in Europe as well as in Asia Pacific.  We had these central pivot points that the attackers were using basically as clearing houses.  Malware was directly writing over the wire right to these systems as they were going thousands of systems at a time, simultaneously as well.</p>

<p>JACK:	Like I said before, the registers all had antivirus installed on it.</p>

<p>COURTNEY:	But it wasnât picking up this malware in particular.</p>

<p>MATT:	This is actually a new variant that weâve uncovered.  It was not previously known.  Thereâs a couple of little surprises about this malware.  First off, it was an unknown variant but itâs a derivative of Tiny POS.  Thereâs a legitimate Tiny POS point-of-sales software, then thereâs a Tiny POS piece of malware.  Tiny POS is piece of malware that is pretty â I donât want to say sophisticated but for what itâs able to do, itâs pretty well-developed.  I say that knowing I just complimented a malware family but itâs real good put together but the kicker here is every single piece of card-scraping malware that we came across in this case was less than 6 KB in size.</p>

<p>COURTNEY:	As we kept adding more and more stores it was definitely a point where weâre like uh, are we going to have millions of cards here?  I think especially as we saw the output files go higher and higher in number I was like oh, well letâs hope some of these overlap.  Yeah, definitely an oh, shit moment.</p>

<p>MATT:	But wait, but wait, hold on, it gets worse than that.  About eighty percent of the systems was the point of sales, the point of sale registers.  The other twenty percent was the back of house systems as well, the back of house systems that sit in the back of the store that no one has access to aside from the store themselves.  But those systems had malware on them as well.  Those systems were also â also had data that was being scraped in them, too.</p>

<p>JACK:	Delivering this kind of news to the client is never easy.  The team had to call the client to tell them what they found.</p>

<p>MATT:	Yeah, I would say it was us, them, and lawyers.  That was a fun chat.  I guess to give you a very brief perspective, thereâs always that moment of like, when you receive that external alert or when your client receives that external alert, thereâs always that moment of is this bullshit?  Or how real is this?  When we had that call we said hey, FYI, we have uncovered this malware.  We found what itâs able to do.  Weâve uncovered all these output files.  The very first reaction because the output files [00:15:00] were encoded, they actually had a custom encoding that the malware was using.  Because they were encoded there was a little bit of well, that data is just garbage, right?  Thereâs nothing in there.  Or like eh, well, we actually decoded it.</p>

<p>There was definitely a little bit of oh shit on their part as well because it becomes real once you find out that your greatest fear has come true, which is someoneâs been hanging out in your house for a while.  [MUSIC]  The lawyers, they do a very good job of letting us get everything out and then they process it and then they come back and ask questions.  But thereâs always a little bit of hesitancy.  They want to make sure youâre correct.  If you come out of the gate and you say yeah, we have evidence of a credit card breach, thereâs a lot of wheels that start to turn.  Youâre on a clock, depending on the state.  Some states youâre on the clock then, about disclosure and that kind of stuff.</p>

<p>Youâve got to file for protection with the credit card brands and everything like that.  They ask as many questions as possible to make sure youâre one hundred percent positive.  What youâve seen backs up â technically you can back up what it is youâre saying because they know that thereâs a lot of money about to be spent based on that finding, based on that opinion.  So next, this is where Courtney and I then fall into the quantification mode where now, okay, weâve got a breach.  Now we need to understand how wide, how big, and how much data is at risk here.  Thatâs kind of the next step that you want to answer, is how much data is actually at risk when you have one of these breaches here, and just how far back does it go?</p>

<p>JACK:	Doing some digital forensics, the team was able to see when the malware was originally installed and where it came from.  From this investigation they found the hackers were in the network forâ¦</p>

<p>MATT:	About seven to eight months they were in there.</p>

<p>COURTNEY:	They were in the network probably at least a solid month of just reconnaissance before they built their perfect piece of malware.  Then even throughout time we saw them make slight modifications to it as they kept going forward.  They knew exactly where to go get the credit cards on every system.</p>

<p>MATT:	Unfortunately the system that they first compromised, that they first came into was no longer available.  I think personally, they came in with a phish only because there was very little exploitation of systems even though there was a very vulnerable environment.  There was very little exploitation of those vulnerabilities and that may be again, because they didnât need to do that.  I donât want to rule that out immediately but I donât know, most of these cases I always see start with some sort of a phish.  Especially to set up the infrastructure that these guys had â that these attackers had set up.  Here, it makes me want to think it was likely a targeted approach but you never know.  You never know until you find it.</p>

<p>JACK:	Phishing is when a hacker targets an employee to try to get them to click something they shouldnât click on.  It could be an e-mail with a malicious link, it could be a Word document with macros enabled.  Once the person clicks the malicious link, that computer can become infected and then under control of the hacker.  When the hacker is in the network, they can move over to another machine to start setting up their malware.</p>

<p>MATT:	With simple [inaudible] math youâre scraping six hundred stores, five to six hundred stores for a period of eight months.  That period of time includes the summer, includes multiple sale weekends, it includes the build-up to Christmas and that kind of stuff.  Including all those various time periods.  You could very easily get into the hundreds of thousands or millions of cards easily with those considerations and those factors.  [MUSIC]  The next step is letâs get these output files parsed, letâs start to incabinate  this data together and letâs start to de-dupe it and see just how much data weâve got exposed here.</p>

<p>COURTNEY:	Yeah, I want to say it took us at least two weeks to get through all of the credit cards and really de-dupe them and make sure that everything we had were actual card numbers.  Something particular in this case that we ran into was credit cards that look like credit card numbers but werenât actually valid card numbers.  That was something that we had to do a lot of de-duplication and verification with, both on our end and with a little bit of help of the card brands, determine if what we were seeing were all actually card numbers.</p>

<p>MATT:	We started uncovering card data that was expired.  [MUSIC]  [00:20:00] Weâre like, how are we finding so much credit card data thatâs expired?  Itâs one thing if you find â letâs say you have twenty numbers from the day and you find one is expired.  Youâre like oh, okay, someone accidentally swiped an old card or something, right?  But then you start to wonder, youâre like why am I seeing this significant percentage of cards that have already expired?  What was happening in this case is, if you remember earlier, I mentioned that the malware was on the back of house systems.</p>

<p>The back of house systems were running SQL servers.  The SQL servers had historical unencrypted tracked data that was being loaded into memory and the malware was picking that up.  They were picking up transactions from as long as four years ago.  The attackers were effectively peeking back in time.  They were looking at transactions from three to four years ago that they had no visibility to, which is another unique angle because most of this malware exists at the swipe, or it exists to steal at the swipe.</p>

<p>JACK:	Now the team is ready to begin removing the malware from the network.  They needed to understand every hole that was in the network and patch every one so that the hackers could not get back in.</p>

<p>COURTNEY:	We didnât actually have to take any of the servers offline.  Once we were able to really find those pivot points, taking those offline or at least making sure that we had process blocking in place, was able to stop it for the most part across the network.</p>

<p>MATT:	Yeah, we ended up shutting down the clearing houses, the central points that they were using.  We ended up taking those off first and then waiting to see what would happen next.  The first time we kicked them out, we actually saw them re-enter through Asia and within about three seconds of re-entering they had re-compromised forty different systems.  [MUSIC]  I never want a company to actually be breached but part of my job is to find that stuff and part of Courtneyâs job is to find that stuff.  Our initial reaction was first off like, ah shit, we knew this was gonna happen.  We didnât know it was gonna happen this fast.  Thatâs reaction one.</p>

<p>Reaction two; usually what happens if you successfully kick an actor out one hundred percent, usually youâll see a phishing campaign or something.  Theyâre trying to get back in.  To see them come through the network with that speed, the next thing is ah, shit, thereâs another back door out there which we got to go track down.  There ended up being a system we didnât have visibility to.  Number three, thereâs that moment where you see how quickly the attackerâs doing what theyâre doing.  That speaks volumes to how long theyâve been in the network.  If youâre watching an attacker, if youâre seeing artifacts from an attacker very recently and it looks like theyâre fumbling around in the dark looking for a light switch, then youâre like, thereâs a very slim, good chance this person hasnât been here that long.</p>

<p>To watch someone re-compromise four dozen machines in ten seconds, okay, this person has come back home, theyâve put their feet up on the couch, they know exactly where the remote is and itâs a very easy thing for them to slide right back into.</p>

<p>COURTNEY:	I think it was interesting to see them come back in so quick but it was also interesting to see which tools they were immediately using.  Because at that point we had the live response there.  We were able, essentially, to sit there and track what they were doing and see exactly how they were moving.  We had some of these records before but it was just nice to actually sit there and be able to confirm oh, they came in through here, okay, well they ran an IP scanner and then they hard-coded and were able to log into all these IPs in the matter of three minutes.</p>

<p>JACK:	The team had discovered that besides the malware, there were also back doors installed on many systems which is how the hackers kept getting back in.</p>

<p>COURTNEY:	They had added 350 back doors.  However, they werenât pushing the malware to each, like all 350 systems didnât have all the malware on it.  It was almost as if they were just allowing themselves access back in incase they ever got closed off.</p>

<p>JACK:	But the team was able to find [00:25:00] each and every back door and take every pivot point offline and stop any more credit cards from leaving the network.  It was a good feeling to finally get this malware under control.</p>

<p>MATT:	There was about a month where every call got worse and worse.  There was definitely a moment of really, is this ever going to end?  You can definitely get bad news [inaudible] after a while but eventually once we started taking things offline, it then turned into positivity and we were able to actually deliver good news calls.  Which is hey, weâve actually remediated things.  The attitude started to shift when â once we had figured out the way the global â the attackerâs global infrastructure was set up.</p>

<p>But itâs only when you get to that point where youâve mapped out the whole world that you can start to actually breathe a little bit.  Luckily this malware was not ingrained to the point where it became symbiotic with the environment like some malware families do.  But this one was pretty easy to delete.  I donât say that as a challenge; I say it as â it was definitely a pain in the rear but it was simple enough to delete and then disable the services to prevent it from running again.</p>

<p>JACK:	As the team was cleaning the malware off the network they gave some suggestions to the company to improve their security.</p>

<p>COURTNEY:	Yeah, some password changes were necessary, maybe something down the line of changing their network infrastructure so itâs not so flat.  That was definitely one of the things that enabled this malware to get as far as it did because every system could essentially reach every other system.  There were similar passwords shared, administrator accounts, privileged accounts that were accessible on many, many machines across the network.  I think this was a big learning point of how to properly secure your network and make sure your encryptionâs in place to prevent this from happening again.</p>

<p>JACK:	To try to trace this hack down to the person who was responsible is sometimes impossible.  You can look for clues in the malware like the language that was used in writing it, or the time zone that itâs set to, but these things are just small clues that arenât very strong.  Trying to figure out who did a hack is called attribution.</p>

<p>MATT:	Iâm a firm believer that attribution doesnât really get you anywhere unless youâre sitting in a political or an executive role and youâve got to make decisions off of who may be behind this keyboard, and that kind of stuff.  However itâs always interesting to know.  The only thing I can say about this one is one thing we havenât mentioned yet; North America, there was one server that was treated as a clearing house.  Then there was two additional systems that had back doors on them.  In Europe it was very much the same thing.  Europe and [inaudible] and whatnot was very much the same way.  There was one or two systems that served as central pivot points.</p>

<p>Asia on the other hand, Asia had somewhere in between 350 and 400 unique back doors installed on it.  Almost every system got a back door.  A lot of the compromise itself actually started in Asia.  It actually started in mostly Southeast Asia and that kind of stuff.  That doesnât lend to any attribution whatsoever.  Itâs just when youâre going after credit card data, itâs a very interesting place to start, if you catch my drift.  Even if you pinpoint it, that specifically, what are you going to do?  Youâre a company thatâs headquartered in the United States.  What recourse do you have?  Youâve got to get your network back up.  Youâve got to get to a point where youâre not having to fight fires every day.  You donât really have time to.  What, are you gonna hire a team to gonna go after these guys or something like that?  Good luck.</p>

<p>JACK:	What was the final number of credit cards that were stolen?</p>

<p>MATT:	That number, to the best of my knowledge, is still being sussed out but I think after everything we can had come across, we landed a little shy of 100,000.  That was all.  Which was a very surprising number and a very relieving number as well.</p>

<p>JACK:	I donât know a lot about the current carding black market conditions but itâs safe to say these are probably too many cards for these hackers to try to scrape money out of themselves.  Theyâre probably selling these cards in bulk somewhere.  The cards go anywhere from ten dollars to a hundred dollars each, so even if they got ten dollars per card, that means these hackers made a million dollars off this company.  Now the company has to do it again to try to clean up the problem.</p>

<p>MATT:	Primarily, then it falls onto the company to work with the banks and work with the credit card companies and get new cards out there.</p>

<p>JACK:	This breach was publically announced and it hit the news, but the publicâs reaction to it wasnât a huge deal.</p>

<p>MATT:	In short it was [00:30:00] not as crazy as youâd think.  It was not that big of a deal.  I say that because youâve got predecessors like Home Depot and Target and some of those huge major breaches, youâve got predecessors like that which received weeks if not months of news.  This one was not as prolific as that.  From that, and the world view.</p>

<p>COURTNEY:	That and then on top of it, with the whole network infrastructure right now and how often weâre almost seeing these reported in the news.  Some of the larger breaches that weâve recently seen, including social security numbers, I guess credit cards kind of a little bit fall to the back.  Youâre always worried it gets stolen but in the back of a lot of peopleâs minds theyâre like oh, Iâll just replace it, get a new one.</p>

<p>JACK:	Besides this being a major headache for this company and even a bigger headache for the credit card companies and banks, this also can severely impact the people whose cards got stolen.  At the beginning of this episode you started to hear from Tom.  Itâs possible that Tomâs card data was stolen and sold on the black market just like in the story you just heard.  Someone used his card fraudulently and his bank was investigating to see what went wrong.  Letâs hear how his story pans out.</p>

<p>TOM:	Well, the morning that they did it was the 12th or 13th of December so this effectively wiped out Christmas.  [MUSIC]  Iâm a licensed contractor and I receive some of my business through an outfit and with my accounts frozen and nothing able to go in or come out, the first thing I found was that they stopped working for me and they said well, your bill is overdue and your bill is overdrawn and we canât get any money so youâre stopped until something happens.</p>

<p>But luckily I had a financial backup on this and so I was able to survive but I could not work until this was finally taken care of.  It made a couple of months where things were very, very difficult.  My main bank had gone through and they said okay, we have found the problem and they had now put everything back the way it was supposed to be.  I was now able to do business with the account but even having done that, it still took a couple of months to get things squared away.  It was a major interruption in my life.</p>

<p>JACK:	Courtney and Matt gave a presentation at the Kaspersky SAS Summit earlier this year.  In their talk they went into detail about this new strain of malware.  They also reported this new strain of malware to the antivirus companies so it can be detected in the future.  Matt has since moved from Kroll and is now working at Cylance and has most recently been accepted as a SANS instructor teaching digital forensics and incident response.</p>

<p>JACK (OUTRO):	[OUTRO MUSIC] Youâve been listening to Darknet Diaries.  For show notes and links, check out darknetdiaries.com.  If you want more InfoSec podcasts, thereâs one that does an episode almost every day.  They do a daily wrap-up of the news and interview some really smart people.  Itâs called the Cyber Wire and I recommend it for your daily commute.  A lot of you are asking how you can help with this show.  Right now Iâm just trying to grow the audience.  Itâs hard to get the word out, so youâd be a big help to me if you would tell others about this podcast.  Think whose phone number you have of someone who might like this show and text them right now to tell them about it, or post about it on social media, or tell your co-workers.  These kinds of things make me super excited to make more episodes.  This show is made entirely by me, Jack Rhysider.  Theme music for this show including this song is made by Breakmaster Cylinder.  [OUTRO MUSIC ENDS]</p>

<p>Hey, one last thing.  [MUSIC]  I made something you might like.  I made a random password generator.  Yeah, itâs a website that creates some fresh, new, random passwords for you.  Just in case you ever need to create a random password, Iâve got you covered.  Oh, and thereâs an extra feature, too.  It has an API which allows you to use it in your own programs.  Anyways, if you want to check out the site itâs called passwordwolf.com.  Thatâs passwordwolf.com.  See you there.</p>

<p>[MUSIC ENDS]</p>

<p>[END OF RECORDING]</p>

<p>Transcription performed by Leah Hervoly
www.leahtranscribes.com</p>


			</pre>

			
			Transcription performed by Leah Hervoly <!-- <a href="https://www.leahtranscribes.com">www.leahtranscribes.com</a> -->
			


		</article>

	</div>

</section>

		</div>

	</div>


	<footer class="footer">

	<div class="wrap">

		<div class="parent3col">
			<div class="column">
				<a href="/"><h2 class="footer__text">Darknet Diaries</h2></a>
				<ul class="socials">
	
	
	<li class="socials__item">
		<a href="http://facebook.com/darknetdiaries/" target="_blank" rel="noopener noreferrer" class="socials__item__link" title="Facebook">
			<i class="fab fa-facebook-f" aria-hidden="true"></i>
		</a>
	</li>
	
	
	
	<li class="socials__item">
		<a href="https://twitter.com/darknetdiaries" target="_blank" rel="noopener noreferrer" class="socials__item__link" title="Twitter">
			<i class="fab fa-twitter" aria-hidden="true"></i>
		</a>
	</li>
	
	
	
	<li class="socials__item">
		<a href="https://www.instagram.com/darknetdiaries/" target="_blank" rel="noopener noreferrer" class="socials__item__link" title="Instagram">
			<i class="fab fa-instagram" aria-hidden="true"></i>
		</a>
	</li>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<li class="socials__item">
		<a href="https://www.reddit.com/r/darknetdiaries/" target="_blank" rel="noopener noreferrer" class="socials__item__link" title="Reddit">
			<i class="fab fa-reddit" aria-hidden="true"></i>
		</a>
	</li>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<li class="socials__item">
		<a href="https://discord.gg/darknetdiaries" target="_blank" rel="noopener noreferrer" class="socials__item__link" title="Discord">
			<i class="fab fa-discord" aria-hidden="true"></i>
		</a>
	</li>		
	<li class="socials__item">
		<a href="https://www.youtube.com/@JackRhysider" target="_blank" rel="noopener noreferrer" class="socials__item__link" title="YouTube">
			<i class="fab fa-youtube" aria-hidden="true"></i>
		</a>
	</li>	
<!-- 	<li class="socials__item">
		<a href="http://uka5ybpmh3u54dkv.onion" target="_blank" rel="noopener noreferrer" class="socials__item__link" title="Onion Address">
			<i class="fa fa-adjust" aria-hidden="true"></i>
		</a>
	</li> -->
	<li class="socials__item">
		<a rel="me noopener noreferrer" target="_blank" href="https://infosec.exchange/@jackrhysider" class="socials__item__link" title="Mastodon">
				<i class="fa-solid fa-quote-left"></i>
		</a>
	</li>
		
</ul>				
			</div>
			<div class="column footer_menu">
				<h5><a href="/episode">Episodes</a><br>
				<a href="/donate">Donate</a><br>
				<a href="https://shop.darknetdiaries.com">Shop</a><br>
				<a href="/links">Links</a></h5>

			</div>			
			<div class="column footer_menu">
				<h5><a href="/about">About</a><br>
				<a href="/reviews">Reviews</a><br>
				<a href="/subscribe">Subscribe</a></h5>
				<div class="footer__copyright">
					<span class="footer__copyright">Â© 2023</span>
				</div>
			</div>
		</div>


	</div>


</footer>


	<!-- Javascript Assets -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="/js/personal-min.js"></script>

	

	
	
	

	<!-- For support visit https://darknetdiaries.com/hotline -->
</body>
</html>